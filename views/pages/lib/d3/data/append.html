<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>fe-note</title>
<style type="text/css">
  * {
    margin:0;
    padding:0;
  }
  html,body {
    width:100%;
    height:100%;
  }
</style>
<script type="text/javascript" src="/assets/lib/jquery/2.1.3/jquery.js"></script>
<script type="text/javascript" src="/assets/lib/d3/3.0.0/d3.js"></script>
<script type="text/javascript">
$(function () {
  var data = [50,75,100,125];
  var colors = d3.scale.category10();
  var bar = d3.select(document.body)
    .selectAll('div')
    .data(data)
    .enter()
    .append('div')
    .style('height','100px')
    .style('background-color',function (d,i) {
      return colors(i);
    })
    .style('width',function (d,i) {
      return d+'px';
    });
  
  // i的指向和想象当中一样，是 0 1 2 3
  console.log('Test1');
  var spans = bar.append('span')
    .html(function ( d, i ) {
      console.log(i+':'+d);
      return d;
    });
  
  // i总是0，但d正确的
  console.log('Test2');
  bar.selectAll('span').each(function (d,i) {
    console.log(i+':'+d);
  });
  
  // i指向是 0 1 2 3，d正确显示每个span上所绑定的数据
  console.log('Test3');
  d3.selectAll('span').each(function (d,i) {
    console.log(i+':'+d);
  });
});
</script>
</head>
<body>
</body>
</html>