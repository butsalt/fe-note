<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>learn</title>
<style type="text/css">

</style>
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function () {
    var form = document.getElementsByTagName('form')[0];
    var inputs = Array.from(form.getElementsByTagName('input'));

    form.getElementsByTagName('button')[0]
        .addEventListener('click', function () {
            var formData = new FormData();

            inputs.forEach(function (input) {
                formData.append(input.name, input.files[0]);
            });

            var xhr = new XMLHttpRequest();
            // method url async
            xhr.open('POST', '/upload', true);

            // 用json格式解析响应信息
            xhr.responseType = 'json';

            // 上传过程回调
            xhr.upload.addEventListener('progress', function (e) {
                if (e.lengthComputable) {
                    console.log(`total: ${e.total}byte; uploaded: ${e.loaded}byte`);
                }
            });

            // 响应下载过程中回调
            xhr.addEventListener('progress', function (e) {
                if (e.lengthComputable) {
                    console.log(`total: ${e.total}byte; downloaded: ${e.loaded}byte`);
                }
            });

            // 响应回调
            xhr.addEventListener('load', function (e) {
                console.log(xhr.response);
            });
            xhr.send(formData);
        });
});
</script>
</head>
<body>
<form enctype="multipart/form-data" method="post" action="/upload">
    <table>
        <tbody>
            <tr>
                <th>文件1：</th>
                <td>
                    <input type="file" name="file1"/>
                </td>
            </tr>
            <tr>
                <th>文件2：</th>
                <td>
                    <input type="file" name="file2"/>
                </td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="2">
                    <button type="button">上传</button>
                </td>
            </tr>
        </tfoot>
    </table>
</form>
</body>
</html>